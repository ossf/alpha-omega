# OpenRefactory Update: August 2023

## Scan Results

Link to results: https://docs.google.com/spreadsheets/d/1K8dc6SrSEoqqh46cFisZM1tiN4CigaXsqkCKfCM8UTs/edit#gid=228743971

In the month of August, the engineers at OpenRefactory focused primarily on Python projects, with a few projects in Golang as well.

The outcome of these efforts thus far:

|  | Aug 2023 |
|--|--|
| Projects analyzed | 132 |
| Projects with no bugs | 98 |
| Total bugs filed | 33 |
| Security bugs filed | 12 |
| Bugs with a fix suggestion | 26 |
| Bugs with a PoC exploit | 6 | 
| Fixes merged by maintainers | 15 (45%) |

In August, 12 security issues were identified, including cross-site scripting, cross-site request forgery, insecure deserialization, open redirect, log injection, sensitive data leaks, and unsafe library call (mktemp) issues.


## Speed of Triaging

In the [July report](update-2023-07.md), we discussed the challenges with false warnings generated by the Omega Analyzer tool. To mitigate this issue, we narrowed down the results to a smaller set of bug categories. Even after that, there had been many bug reports. As an example, within the acl-anthology project, Semgrep flagged 241 bugs. This project houses a total of 87,833 papers dedicated to the exploration of computational linguistics and natural language processing.

A recurring bug report featured the following message:

```
"Found 'subprocess' function 'call' with 'shell=True'. This is dangerous because this call will
spawn the command using a shell process. Doing so propagates current shell settings and 
variables, which makes it much easier for a malicious actor to execute commands. 
Use 'shell=False' instead."
```
However, the context of the application is such that certain scripts run within a trusted environment, generating static web pages. All commands directed to `subprocess.call()` were hardcoded, rendering these cases impervious to command injection attacks.

Furthermore, Semgrep detected the utilization of the pickle library and consequently reported deserialization issues. Nevertheless, the serialization and deserialization processes were confined to trusted data. While the practice of using the pickle library is ill-advised, the warnings themselves were false positives. In other instances, Semgrep displayed duplicated entries for the same bug under different rules.

Ultimately, all 241 reported bugs were deemed false positives. Resolving this required two security engineers, each dedicating two days to triage the reported issues.


## Improvement in Bug Acceptance Rate
The bug acceptance rate, which stands at 45%, surpasses the rate achieved in the [previous work](https://www.openrefactory.com/how-to-serve-open-source-software-maintainers-without-annoying-them/) undertaken by OpenRefactory. Several factors have contributed to this notable improvement, including:

 - **Change in Patch Submission Account:** In contrast to the previous approach where patches were sent from a company account, the current patches are submitted from personal accounts. This shift has eliminated confusion surrounding the motivation behind the contributions. Additionally, the report now provides a transparent outline of the Alpha-Omega project's objectives. This clarity has played a significant role in enhancing the merge rate. A sample bug report is [here](https://github.com/ansible/ansible/pull/81511).


 - **Demonstration of Exploits:** For critical security bugs, addressing concerns regarding the potential attack surface is vital. OpenRefactory engineers have effectively expedited the decision-making process by presenting demo code that showcases potential exploits. It is important to note that the exploit codes developed serve as hypothetical scenarios illustrating potential attack vectors, rather than actual malicious attack attempts. A sample bug report with an exploit is [here](https://github.com/voxel51/fiftyone/issues/3396). 


 - **Focused Bug Prioritization:** We only focused on critical security issues and other bugs that are of medium and high severity. This approach immediately underscores the significance of the bug fixes to maintainers. The inherent understanding of the importance of these bug resolutions has contributed to the higher merge rate.


## Use of Private Vulnerability Reporting (PVR)
We followed the approach set by the [Open Auto Vulnerability Disclose project](https://github.com/ossf/open-auto-vuln-disclose)  to report the bugs.  Here's a breakdown of the bug reporting process:

 1. **Security Bug Reporting**:
      -  We first made an attempt to open a security advisory following the private vulnerability reporting ([PVR](https://docs.github.com/en/code-security/security-advisories/guidance-on-reporting-and-writing/privately-reporting-a-security-vulnerability)) approach. This is done programmatically. 
      - If the PVR feature is enabled, we proceed with submitting the report.  In one case, the maintainer enabled PVR.  
      - If not enabled, we opened an Issue requesting the maintainers to enable PVR for the repository.
      - In other cases, the maintainers suggested that we file the bug in some other way, e.g., emailing them or reporting through platforms such as HackerOne. At that point, we followed the guideline. 
      - In one project, the maintainer has not responded for more than three weeks. We are waiting for 30 days to expire before attempting to contact with them again. 
 1. **Non-Security Bug Reporting**:
    -   For non-security bugs where fixes were available, we submitted pull requests containing the fixes.
    -   For bugs without available fixes, we opened issues.


## Related Documents and Codebases:
- Blog: [How to serve open source maintainers without annoying them?](https://www.openrefactory.com/how-to-serve-open-source-software-maintainers-without-annoying-them/)
- Codebase: [Open Auto Vulnerability Disclose project](https://github.com/ossf/open-auto-vuln-disclose)
